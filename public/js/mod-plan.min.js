function ModuleSemester(){this.mods=[];this.totalMC=0;this.checkMod=function(e){for(var t=0;t<this.mods.length;t++){if(this.mods[t]["ModuleCode"]==e){return true}}return false}}function checkSem(e,t){for(var n=0;n<t["History"].length;n++){if((e+1)%2+1==t["History"][n]["Semester"]){return true}}return false}function checkModules(e){for(var t=0;t<8;t++){if(choice[t].checkMod(e)){return true}}return false}function checkPrereq(e,t,n){if(t[" and "]){return checkPrereq(e,t[" and "],"and")}else if(t[" or "]){return checkPrereq(e,t[" or "],"or")}else if(t instanceof Array){if(n=="and"){console.log("test");for(var r=0;r<t.length;r++){if(!checkPrereq(e,t[r],"and")){return false}}return true}else if(n=="or"){for(var r=0;r<t.length;r++){if(checkPrereq(e,t[r],"or")){return true}}return false}}else{console.log(t);for(var r=e-1;r>=0;r--){if(choice[r].checkMod(t)){return true}}return false}}function checkPreclusion(e){for(var t=0;t<e.length;t++){for(var n=0;n<8;n++){if(choice[n].checkMod(e[t])){return false}}}return true}function addModules(e,t){if(checkModules(t)){alert(t+" is already in your plan!")}else{$.get("/mod/"+t,function(n){if(checkSem(e,n)){var r=true;var i=true;if(n["ParsedPrerequisite"]){r=checkPrereq(e,n["ParsedPrerequisite"],"and")}if(n["ParsedPreclusion"]){i=checkPreclusion(n["ParsedPreclusion"])}if(!i){addWarning();$("#warning").append('<strong>Please check whether you have satisfied the preclusion for <a class="alert-link" href="javascript:showDetails('+"'"+n["ModuleCode"]+"'"+')">'+n["ModuleCode"]+"</a>!</strong>")}else if(!r){addWarning();$("#warning").append('<strong>Please check whether you have satisfied the prerequisite for <a class="alert-link" href="javascript:showDetails('+"'"+n["ModuleCode"]+"'"+')">'+n["ModuleCode"]+"</a>!</strong>")}else{choice[e-1].addMod(n);$("#content-sem"+e).append('<tr><td><a href="javascript:showDetails('+"'"+n["ModuleCode"]+"'"+')">'+n["ModuleCode"]+"</a></td><td>"+n["ModuleTitle"]+'</td><td class="action-button"><center><a href="#" title="info" class="info-button hidden-xs"><span class="glyphicon glyphicon-info-sign" style="color: #000000;"></span></a><a href="#" title="remove" class="remove-button"><span class="glyphicon glyphicon-remove-sign" style="color: #000000;"></span></a></center></td></tr>');$("#total-credit"+e.toString()).html(choice[e-1].totalMC.toString())}}else{alert(t+" is not available on this semester!")}},"json")}}function addWarning(){if($(".alert").length){$(".alert").alert("close")}console.log("test123123");$("#alert-container").append('<div class="alert alert-danger alert-dismissible" role="alert" ><button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><span id="warning"></span></div>')}function deleteModule(e,t){choice[e-1].delMod(t);$("#total-credit"+e.toString()).html(choice[e-1].totalMC.toString())}function save(){var e=[];for(var t=0;t<choice.length;t++){for(var n=0;n<choice[t].mods.length;n++){if(n==0)e[t]="";if(n==choice[t].mods.length-1){e[t]=e[t]+choice[t].mods[n]["ModuleCode"]}else{e[t]=e[t]+choice[t].mods[n]["ModuleCode"]+" "}}}var r=e.join(",");$.post("/plan",{mods:r})}function showDetails(e){$.get("/mod/"+e,function(t){emptyDetails();$("#moduleTitle").append(e+" - "+t["ModuleTitle"]);$("#moduleDescription").append("<p>"+t["ModuleDescription"]+"</p>");$("#moduleCredit").append("<p>Module Credit:  "+t["ModuleCredit"]+"</p>");$("#moduleWorkload").append("<p>Workload:  "+t["Workload"]+"</p>");if(t["Prerequisite"])$("#modulePrereq").append("<p>Prerequisite:  "+t["Prerequisite"]+"</p>");else $("#modulePrereq").append("<p>Prerequisite:  Nil</p>");if(t["Preclusion"])$("#modulePreclus").append("<p>Preclusion:  "+t["Preclusion"]+"</p>");else $("#modulePreclus").append("<p>Preclusion:  Nil</p>");var n="<p>Semester:  ";for(var r=0;r<t["History"].length;r++){var i=t["History"][r]["Semester"];var s=i.toString();if(i==3)s="Special Term 1";else if(i==4)s="Special Term 2";n+=s.toString();if(r!=t["History"].length-1)n+=", "}n+="</p>";$("#moduleSemester").append(n);$("#moduleDetails").modal("show")},"json")}function emptyDetails(){$("#moduleTitle").empty();$("#moduleDescription").empty();$("#moduleCredit").empty();$("#moduleWorkload").empty();$("#modulePrereq").empty();$("#modulePreclus").empty();$("#moduleSemester").empty()}ModuleSemester.prototype.addMod=function(e){this.mods[this.mods.length]=e;this.totalMC+=parseInt(e["ModuleCredit"])};ModuleSemester.prototype.delMod=function(e){var t=0;for(var n=0;n<this.mods.length;n++){if(this.mods[n]["ModuleCode"]==e){t=n;break}}this.totalMC-=parseInt(this.mods[t]["ModuleCredit"]);this.mods.splice(t,1)};var choice=[];for(var i=0;i<8;i++){choice[i]=new ModuleSemester}